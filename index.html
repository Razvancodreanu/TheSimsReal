<!DOCTYPE html>
<html lang="ro">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Sims Real</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f4f8;
            padding: 20px;
            max-width: 500px;
            margin: auto;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }

        .bar-container {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        progress {
            width: 100%;
            height: 20px;
        }

        input[type="number"] {
            width: 60px;
            margin-top: 5px;
        }

        button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #0077cc;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
        }

        .suggestions {
            margin-top: 20px;
            padding: 10px;
            background-color: #e0f7fa;
            border-radius: 5px;
            text-align: center;
        }
    </style>
</head>

<body>
    <h1>The Sims Real</h1>

    <div class="bar-container">
        <label for="nevoi">Nevoi Personale</label>
        <progress id="nevoi" max="100" value="50"></progress>
        <input type="number" id="nevoiInput" placeholder="+/-" />
    </div>

    <div class="bar-container">
        <label for="relatii">Relații</label>
        <progress id="relatii" max="100" value="50"></progress>
        <input type="number" id="relatiiInput" placeholder="+/-" />
    </div>

    <div class="bar-container">
        <label for="cariera">Carieră</label>
        <progress id="cariera" max="100" value="50"></progress>
        <input type="number" id="carieraInput" placeholder="+/-" />
    </div>

    <button onclick="updateBars()">Actualizează</button>
    <div id="suggestions" class="suggestions"></div>
    <canvas id="progressChart" style="margin-top: 20px;"></canvas>

    <script>
        const bars = ['nevoi', 'relatii', 'cariera'];

        function loadProgress() {
            bars.forEach(bar => {
                const saved = localStorage.getItem(bar);
                if (saved !== null) {
                    document.getElementById(bar).value = parseInt(saved);
                }
            });
            checkDailyDecay();
            updateChart();
            showSuggestions();
        }

        function checkDailyDecay() {
            const today = new Date().toISOString().split('T')[0];
            const lastUpdate = localStorage.getItem('lastUpdate') || today;

            if (lastUpdate !== today) {
                bars.forEach(bar => {
                    const progress = document.getElementById(bar);
                    let newValue = Math.max(0, progress.value - 10);
                    progress.value = newValue;
                    localStorage.setItem(bar, newValue);
                    saveHistory(bar, newValue);
                });
                localStorage.setItem('lastUpdate', today);
            }
        }

        function saveHistory(bar, value) {
            const today = new Date().toISOString().split('T')[0];
            let history = JSON.parse(localStorage.getItem(bar + '_history') || '{}');
            history[today] = value;
            localStorage.setItem(bar + '_history', JSON.stringify(history));
        }

        function updateChart() {
            const ctx = document.getElementById('progressChart').getContext('2d');
            const dates = [];
            const data = { nevoi: [], relatii: [], cariera: [] };

            // Adună ultimele 7 zile
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                dates.push(date.toISOString().split('T')[0]);
            }

            bars.forEach(bar => {
                const history = JSON.parse(localStorage.getItem(bar + '_history') || '{}');
                dates.forEach(date => {
                    data[bar].push(history[date] || 0);
                });
            });

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [
                        {
                            label: 'Nevoi Personale',
                            data: data.nevoi,
                            borderColor: '#ff6384',
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            fill: true
                        },
                        {
                            label: 'Relații',
                            data: data.relatii,
                            borderColor: '#36a2eb',
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            fill: true
                        },
                        {
                            label: 'Carieră',
                            data: data.cariera,
                            borderColor: '#4bc0c0',
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        function showSuggestions() {
            const suggestions = [];
            bars.forEach(bar => {
                const value = document.getElementById(bar).value;
                if (value < 50) {
                    if (bar === 'nevoi') suggestions.push('Nevoi Personale jos: Ia o pauză sau mănâncă sănătos!');
                    if (bar === 'relatii') suggestions.push('Relații jos: Contactează un prieten sau familie.');
                    if (bar === 'cariera') suggestions.push('Carieră jos: Setează un obiectiv mic pentru azi.');
                }
            });

            const suggestionDiv = document.getElementById('suggestions');
            suggestionDiv.textContent = suggestions.length > 0 ? suggestions.join(' ') : 'Totul e echilibrat!';
        }

        function updateBars() {
            bars.forEach(bar => {
                const input = document.getElementById(bar + 'Input');
                const progress = document.getElementById(bar);
                const change = parseInt(input.value);
                if (!isNaN(change)) {
                    let newValue = Math.min(100, Math.max(0, progress.value + change));
                    progress.value = newValue;
                    localStorage.setItem(bar, newValue);
                    saveHistory(bar, newValue);
                    input.value = '';
                }
            });
            localStorage.setItem('lastUpdate', new Date().toISOString().split('T')[0]);
            showSuggestions();
            // Reîncarcă graficul după actualizare
            document.getElementById('progressChart').remove();
            const newCanvas = document.createElement('canvas');
            newCanvas.id = 'progressChart';
            newCanvas.style.marginTop = '20px';
            document.body.appendChild(newCanvas);
            updateChart();
        }

        loadProgress();
    </script>
</body>

</html>